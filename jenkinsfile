pipeline {
  agent { docker {image "python:3"} }
  stages {
        stage('deploy') {
            steps {
                sh 'docker exec python python --version'
                sh 'rm -r /deploy/rp-portfolio'
                sh 'cp -r ./rp-portfolio /deploy'
                sh 'python /deploy/rp-portfolio/manage.py makemigrations /deploy/rp-portfolio/projects'
                sh 'python /deploy/rp-portfolio/manage.py migrate /deploy/rp-portfolio/projects'
                sh 'python /deploy/rp-portfolio/manage.py runserver 0.0.0.0:8000'
            }
        }
    }
}
