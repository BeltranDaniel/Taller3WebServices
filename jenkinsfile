pipeline {
  agent { docker {image "python:3"} }
  stages { 
        stage('set-up'){
           steps{ 
              sh 'python -m pip install pylint'
              sh 'python -m pip install Django'
           }
        }
        stage('lint'){
          steps{ 
               try {
                  sh 'pylint ./rp-portfolio --output-format=html'
                } catch (err) {
                   echo err.getMessage()
                }
          }
        }
        stage('deploy') {
            steps {
               sh 'cp -r ./rp-portfolio /deploy'
               dir("/deploy/rp-portfolio") {
                  sh "ls -l"
                  sh 'python manage.py makemigrations projects'
                  sh 'python manage.py migrate projects'
              }
           }
        }
    }
}
